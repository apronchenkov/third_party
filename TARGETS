cc_library(
    name='gtest',
    srcs=[
        'googletest/googletest/src/gtest-all.cc',
        'googletest/googletest/src/gtest_main.cc',
    ],
    compiler_flags=[
        '-Isrc/github.com/apronchenkov/third_party/googletest/googletest',
        '-Wno-missing-field-initializers',
    ],
    transitive_compiler_flags=[
        '-isystem src/github.com/apronchenkov/third_party/googletest/googletest/include',
    ], )

cc_library(
    name='rapidjson',
    transitive_compiler_flags=[
        '-isystem src/github.com/apronchenkov/third_party/rapidjson/include',
    ], )

cc_library(
    name='eigen',
    transitive_compiler_flags=[
        '-isystem src/github.com/apronchenkov/third_party/eigen-include',
    ], )

cc_library(
    name='http_parser',
    srcs=[
        'http-parser/http_parser.c',
    ],
    compiler_flags=[
        '-DNDEBUG',
        '-isystem src/github.com/apronchenkov/third_party/http-parser-include/http_parser',
    ],
    transitive_compiler_flags=[
        '-isystem src/github.com/apronchenkov/third_party/http-parser-include',
        '-DHTTP_MAX_HEADER_SIZE=4096',
    ], )

cc_library(
    name='uthash',
    transitive_compiler_flags=[
        '-isystem src/github.com/apronchenkov/third_party/uthash-include',
    ], )

cc_library(
    name='fmt',
    srcs=[
        'fmt/src/format.cc',
        'fmt/src/posix.cc',
    ],
    transitive_compiler_flags=[
        '-isystem src/github.com/apronchenkov/third_party/fmt/include',
    ],
    compiler_flags=[
        '-DNDEBUG=1',
        '-Weverything',
        '-Wpedantic',
        '-Wno-weak-vtables',
        '-Wno-padded',
        '-Wno-gnu-statement-expression',
        '-Wno-c++98-compat',
        '-Wno-c++98-compat-pedantic',
        '-Wno-reserved-id-macro',
        '-Wno-global-constructors',
        '-Wno-disabled-macro-expansion',
        '-Wno-switch-enum',
        '-Wno-documentation-unknown-command',
        '-Wno-gnu-string-literal-operator-template',
        '-Wno-unused-member-function',
        '-Wno-format-nonliteral',
        '-Wno-missing-noreturn',
        '-Wno-undefined-func-template',
        '-Wno-shadow',
        '-Wno-sign-conversion',
        '-Wno-used-but-marked-unused',
        '-Wno-covered-switch-default',
        '-Wno-missing-variable-declarations',
        '-Wno-double-promotion',
        '-Wno-zero-as-null-pointer-constant',
        '-Wno-gnu-string-literal-operator-template',
    ], )

cc_library(
    name='double_conversion',
    srcs=[
        'double-conversion/double-conversion/bignum.cc',
        'double-conversion/double-conversion/bignum-dtoa.cc',
        'double-conversion/double-conversion/cached-powers.cc',
        'double-conversion/double-conversion/diy-fp.cc',
        'double-conversion/double-conversion/double-conversion.cc',
        'double-conversion/double-conversion/fast-dtoa.cc',
        'double-conversion/double-conversion/fixed-dtoa.cc',
        'double-conversion/double-conversion/strtod.cc',
    ],
    transitive_compiler_flags=[
        '-isystem src/github.com/apronchenkov/third_party/double-conversion-include',
    ],
    compiler_flags=[
        '-Wall',
        '-Werror',
        '-O3',
        '-DNDEBUG',
    ], )

SQLITE_COMPILER_FLAGS = [
    '-O3',
    '-Wno-unused-parameter',
    '-Wno-overlength-strings',
    '-DNDEBUG=1',
    # Recommended Compile-time Options (https://www.sqlite.org/compile.html)
    '-DSQLITE_THREADSAFE=0',
    '-DSQLITE_DEFAULT_MEMSTATUS=0',
    '-DSQLITE_DEFAULT_WAL_SYNCHRONOUS=1',
    '-DSQLITE_LIKE_DOESNT_MATCH_BLOBS',
    '-DSQLITE_MAX_EXPR_DEPTH=0',
    '-DSQLITE_OMIT_DECLTYPE',
    '-DSQLITE_OMIT_DEPRECATED',
    '-DSQLITE_OMIT_PROGRESS_CALLBACK',
    '-DSQLITE_OMIT_SHARED_CACHE',
    '-DSQLITE_USE_ALLOCA',
    # Platform Configuration
    '-DHAVE_FDATASYNC=1',
    '-DHAVE_GMTIME_R=1',
    '-DHAVE_ISNAN=1',
    '-DHAVE_LOCALTIME_R=1',
    '-DHAVE_READLINE=1',
    '-DUSLEEP=1',
]

cc_library(
    name='sqlite',
    srcs=[
        'sqlite-amalgamation/sqlite3.c',
    ],
    transitive_compiler_flags=[
        '-isystem src/github.com/apronchenkov/third_party/sqlite-include',
    ],
    compiler_flags=[
        '-Isrc/github.com/apronchenkov/third_party/sqlite-include',
    ] + SQLITE_COMPILER_FLAGS, )

# cc_binary(
#     name='sqlite_shell',
#     srcs=[
#         'sqlite-amalgamation/shell.c',
#     ],
#     deps=[
#         ':sqlite',
#     ],
#     compiler_flags=SQLITE_COMPILER_FLAGS,
#     linker_flags=[
#         '-lreadline',
#     ], )
